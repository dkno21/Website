<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyek Baru [B96E5D5]</title>
    <style>
        /* Reset dan Styling Dasar */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            /* Variabel untuk tema terang */
            --bg-color: #ffffff;
            --text-color: #333333;
            --header-bg: #f5f5f5;
            --border-color: #dddddd;
            --accent-color: #e94560;
            --secondary-color: #8d8daa;
            --sidebar-bg: #f5f5f5;
            --stat-color: #e94560;
            --overlay-color: rgba(0, 0, 0, 0.3);
            --chat-bg: #f9f9f9;
            --chat-msg-user: #e3f2fd;
            --chat-msg-other: #f1f1f1;
        }

        body.dark-theme {
            /* Variabel untuk tema gelap */
            --bg-color: #1a1a2e;
            --text-color: #e6e6e6;
            --header-bg: #16213e;
            --border-color: #0f3460;
            --accent-color: #e94560;
            --secondary-color: #8d8daa;
            --sidebar-bg: #16213e;
            --stat-color: #e94560;
            --overlay-color: rgba(0, 0, 0, 0.5);
            --chat-bg: #0f3460;
            --chat-msg-user: #1a3a5f;
            --chat-msg-other: #16213e;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s, color 0.3s;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: var(--header-bg);
            border-bottom: 2px solid var(--border-color);
            transition: background-color 0.3s, border-color 0.3s;
        }

        .menu-btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .menu-btn:hover {
            transform: scale(1.1);
        }

        .time-display {
            font-size: 16px;
            font-weight: bold;
            text-align: right;
        }

        /* Sidebar Menu */
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100vh;
            background-color: var(--sidebar-bg);
            transition: left 0.4s ease;
            z-index: 1000;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
        }

        .menu-items {
            list-style: none;
            margin-bottom: 20px;
        }

        .menu-items li {
            margin-bottom: 15px;
        }

        .menu-items a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 18px;
            display: block;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .menu-items a:hover {
            background-color: var(--border-color);
        }

        /* Konten Utama */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
            text-align: center;
        }

        .title {
            font-size: 36px;
            margin-bottom: 20px;
            color: var(--accent-color);
        }

        .subtitle {
            font-size: 20px;
            margin-bottom: 40px;
            color: var(--secondary-color);
        }

        .separator {
            width: 80%;
            height: 2px;
            background-color: var(--border-color);
            margin: 30px auto;
        }

        /* Footer */
        footer {
            background-color: var(--header-bg);
            padding: 20px;
            text-align: center;
            border-top: 2px solid var(--border-color);
            transition: background-color 0.3s, border-color 0.3s;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }

        .stat-item {
            font-size: 18px;
        }

        .stat-value {
            font-weight: bold;
            color: var(--stat-color);
        }

        /* Overlay untuk menutup menu */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--overlay-color);
            z-index: 999;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        /* Form Rating */
        .rating-form {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .rating-form h3 {
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .star-rating {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 15px;
        }

        .star {
            font-size: 30px;
            color: var(--secondary-color);
            cursor: pointer;
            transition: color 0.2s;
        }

        .star.active {
            color: #ffc107;
        }

        .submit-rating {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .submit-rating:hover {
            background-color: #c73e54;
        }

        /* Toggle Tema */
        .theme-toggle {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .theme-toggle span {
            font-size: 18px;
        }

        .theme-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .theme-icon {
            font-size: 24px;
            margin-left: 10px;
        }

        /* Form Login/Register */
        .auth-form {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .auth-form h3 {
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .auth-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .auth-tab.active {
            background-color: var(--border-color);
            font-weight: bold;
        }

        .auth-content {
            display: none;
        }

        .auth-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .auth-button {
            width: 100%;
            padding: 10px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .auth-button:hover {
            background-color: #c73e54;
        }

        /* Profil Pengguna */
        .user-profile {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .user-profile h3 {
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .profile-info {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .profile-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 20px;
            margin-right: 15px;
        }

        .profile-details {
            flex: 1;
        }

        .profile-name {
            font-weight: bold;
            font-size: 18px;
        }

        .profile-rank {
            color: var(--secondary-color);
        }

        .logout-button {
            width: 100%;
            padding: 10px;
            background-color: #ff4757;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .logout-button:hover {
            background-color: #ff3742;
        }

        /* Live Chat */
        .live-chat {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .live-chat h3 {
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .chat-container {
            height: 300px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background-color: var(--chat-bg);
        }

        .chat-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 18px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .message-user {
            background-color: var(--chat-msg-user);
            margin-left: auto;
            text-align: right;
        }

        .message-other {
            background-color: var(--chat-msg-other);
        }

        .message-sender {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 3px;
        }

        .message-text {
            font-size: 14px;
        }

        .message-time {
            font-size: 10px;
            opacity: 0.7;
            margin-top: 3px;
        }

        .chat-input {
            display: flex;
            border-top: 1px solid var(--border-color);
        }

        .chat-input input {
            flex: 1;
            padding: 10px;
            border: none;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .chat-input button {
            padding: 10px 15px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .chat-input button:hover {
            background-color: #c73e54;
        }

        .chat-login-prompt {
            text-align: center;
            padding: 20px;
            color: var(--secondary-color);
        }

        /* Responsif */
        @media (max-width: 768px) {
            .sidebar {
                width: 250px;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .time-display {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- Header dengan Menu dan Waktu -->
    <header>
        <button class="menu-btn" id="menuBtn">‚ò∞</button>
        <div class="time-display" id="timeDisplay"></div>
    </header>

    <!-- Sidebar Menu -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>Menu</h2>
            <button class="close-btn" id="closeBtn">√ó</button>
        </div>
        <ul class="menu-items">
            <li><a href="#">Beranda</a></li>
            <li><a href="#">Tentang</a></li>
            <li><a href="#">Layanan</a></li>
            <li><a href="#">Kontak</a></li>
            <li><a href="#">Bantuan</a></li>
        </ul>
        
        <!-- Form Rating di dalam Menu -->
        <div class="rating-form">
            <h3>Beri Rating Website</h3>
            <div class="star-rating" id="starRating">
                <span class="star" data-value="1">‚òÖ</span>
                <span class="star" data-value="2">‚òÖ</span>
                <span class="star" data-value="3">‚òÖ</span>
                <span class="star" data-value="4">‚òÖ</span>
                <span class="star" data-value="5">‚òÖ</span>
            </div>
            <button class="submit-rating" id="submitRating">Kirim Rating</button>
        </div>
        
        <!-- Toggle Tema -->
        <div class="theme-toggle">
            <span>Mode Gelap</span>
            <div style="display: flex; align-items: center;">
                <label class="theme-switch">
                    <input type="checkbox" id="themeToggle">
                    <span class="slider"></span>
                </label>
                <span class="theme-icon" id="themeIcon">üåô</span>
            </div>
        </div>
        
        <!-- Form Login/Register atau Profil Pengguna -->
        <div id="authSection">
            <!-- Akan diisi dengan form login/register atau profil berdasarkan status login -->
        </div>
        
        <!-- Live Chat -->
        <div class="live-chat">
            <h3>Live Chat</h3>
            <div id="chatContainer">
                <!-- Akan diisi dengan chat container atau prompt login -->
            </div>
        </div>
    </div>

    <!-- Overlay untuk menutup menu -->
    <div class="overlay" id="overlay"></div>

    <!-- Konten Utama -->
    <main class="main-content">
        <h1 class="title">TEST KUN</h1>
        <p class="subtitle">Website ini adalah contoh</p>
        <div class="separator"></div>
    </main>

    <!-- Footer dengan Statistik -->
    <footer>
        <div class="stats">
            <div class="stat-item">
                TOTAL PENGUNJUNG : <span class="stat-value" id="visitorCount">0</span>
            </div>
            <div class="stat-item">
                RATING WEB : <span class="stat-value" id="webRating">9,5</span>
            </div>
        </div>
    </footer>

    <script>
        // Elemen DOM
        const menuBtn = document.getElementById('menuBtn');
        const closeBtn = document.getElementById('closeBtn');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const timeDisplay = document.getElementById('timeDisplay');
        const visitorCount = document.getElementById('visitorCount');
        const webRating = document.getElementById('webRating');
        const stars = document.querySelectorAll('.star');
        const submitRating = document.getElementById('submitRating');
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const authSection = document.getElementById('authSection');
        const chatContainer = document.getElementById('chatContainer');
        
        let currentRating = 0;
        let hasVisited = false;
        let currentUser = null;
        let chatMessages = [];

        // Fungsi untuk membuka menu
        function openMenu() {
            sidebar.classList.add('active');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Fungsi untuk menutup menu
        function closeMenu() {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Event listener untuk tombol menu
        menuBtn.addEventListener('click', openMenu);
        closeBtn.addEventListener('click', closeMenu);
        overlay.addEventListener('click', closeMenu);

        // Fungsi untuk update waktu real-time
        function updateTime() {
            const now = new Date();
            
            // Format hari
            const dayNames = ['MINGGU', 'SENIN', 'SELASA', 'RABU', 'KAMIS', 'JUMAT', 'SABTU'];
            const dayName = dayNames[now.getDay()];
            
            // Format tanggal
            const day = String(now.getDate()).padStart(2, '0');
            
            // Format bulan
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'];
            const month = monthNames[now.getMonth()];
            
            // Format tahun (2 digit terakhir)
            const year = String(now.getFullYear()).slice(-2);
            
            // Format waktu
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            
            // Format waktu sesuai permintaan: "KAMIS Petang 30/okt/25 18:32:50"
            timeDisplay.innerHTML = `${dayName}<br>${day}/${month.toLowerCase()}/${year} ${hours}:${minutes}:${seconds}`;
        }

        // Update waktu setiap detik
        updateTime();
        setInterval(updateTime, 1000);

        // Fungsi untuk menghitung pengunjung unik
        function countUniqueVisitor() {
            // Cek apakah pengunjung sudah pernah mengunjungi
            if (!localStorage.getItem('hasVisited')) {
                // Jika belum, tandai dan tambah counter
                localStorage.setItem('hasVisited', 'true');
                
                // Ambil jumlah pengunjung saat ini dari localStorage
                let currentCount = parseInt(localStorage.getItem('visitorCount') || '0');
                currentCount++;
                
                // Simpan kembali ke localStorage
                localStorage.setItem('visitorCount', currentCount.toString());
                
                // Update tampilan
                visitorCount.textContent = currentCount;
            } else {
                // Jika sudah pernah, tetap tampilkan jumlah yang ada
                const currentCount = parseInt(localStorage.getItem('visitorCount') || '0');
                visitorCount.textContent = currentCount;
            }
        }

        // Fungsi untuk sistem rating
        function initializeRating() {
            // Set event listener untuk bintang
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    currentRating = value;
                    
                    // Update tampilan bintang
                    stars.forEach((s, index) => {
                        if (index < value) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
            });
            
            // Event listener untuk tombol submit rating
            submitRating.addEventListener('click', function() {
                if (currentRating > 0) {
                    // Simpan rating ke localStorage
                    const ratings = JSON.parse(localStorage.getItem('ratings') || '[]');
                    ratings.push(currentRating);
                    localStorage.setItem('ratings', JSON.stringify(ratings));
                    
                    // Hitung rata-rata rating
                    const averageRating = calculateAverageRating(ratings);
                    
                    // Update tampilan rating
                    webRating.textContent = averageRating.toFixed(1).replace('.', ',');
                    
                    // Reset bintang
                    stars.forEach(star => star.classList.remove('active'));
                    currentRating = 0;
                    
                    // Tutup menu setelah memberikan rating
                    closeMenu();
                    
                    alert('Terima kasih atas rating Anda!');
                } else {
                    alert('Silakan pilih rating terlebih dahulu.');
                }
            });
            
            // Load rating yang sudah ada
            const ratings = JSON.parse(localStorage.getItem('ratings') || '[]');
            if (ratings.length > 0) {
                const averageRating = calculateAverageRating(ratings);
                webRating.textContent = averageRating.toFixed(1).replace('.', ',');
            }
        }

        // Fungsi untuk menghitung rata-rata rating
        function calculateAverageRating(ratings) {
            if (ratings.length === 0) return 9.5; // Default rating
            const sum = ratings.reduce((a, b) => a + b, 0);
            return sum / ratings.length;
        }

        // Fungsi untuk mengatur tema
        function initializeTheme() {
            // Cek preferensi tema yang disimpan
            const savedTheme = localStorage.getItem('theme');
            
            // Jika tema gelap disimpan, aktifkan tema gelap
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                themeToggle.checked = true;
                themeIcon.textContent = 'üåô';
            } else {
                document.body.classList.remove('dark-theme');
                themeToggle.checked = false;
                themeIcon.textContent = '‚òÄÔ∏è';
            }
            
            // Event listener untuk toggle tema
            themeToggle.addEventListener('change', function() {
                if (this.checked) {
                    document.body.classList.add('dark-theme');
                    localStorage.setItem('theme', 'dark');
                    themeIcon.textContent = 'üåô';
                } else {
                    document.body.classList.remove('dark-theme');
                    localStorage.setItem('theme', 'light');
                    themeIcon.textContent = '‚òÄÔ∏è';
                }
            });
        }

        // Fungsi untuk sistem login/register
        function initializeAuth() {
            // Cek apakah user sudah login
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                renderUserProfile();
                renderChatContainer();
            } else {
                renderAuthForm();
                renderChatLoginPrompt();
            }
            
            // Load chat messages
            loadChatMessages();
        }

        // Render form login/register
        function renderAuthForm() {
            authSection.innerHTML = `
                <div class="auth-form">
                    <h3>Login / Daftar</h3>
                    <div class="auth-tabs">
                        <button class="auth-tab active" data-tab="login">Masuk</button>
                        <button class="auth-tab" data-tab="register">Daftar</button>
                    </div>
                    <div class="auth-content active" id="loginContent">
                        <div class="form-group">
                            <label for="loginUsername">Nama Pengguna</label>
                            <input type="text" id="loginUsername" placeholder="Masukkan nama pengguna">
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Kata Sandi</label>
                            <input type="password" id="loginPassword" placeholder="Masukkan kata sandi">
                        </div>
                        <button class="auth-button" id="loginButton">Masuk</button>
                    </div>
                    <div class="auth-content" id="registerContent">
                        <div class="form-group">
                            <label for="registerUsername">Nama Pengguna</label>
                            <input type="text" id="registerUsername" placeholder="Buat nama pengguna">
                        </div>
                        <div class="form-group">
                            <label for="registerPassword">Kata Sandi</label>
                            <input type="password" id="registerPassword" placeholder="Buat kata sandi">
                        </div>
                        <div class="form-group">
                            <label for="registerConfirmPassword">Konfirmasi Kata Sandi</label>
                            <input type="password" id="registerConfirmPassword" placeholder="Ulangi kata sandi">
                        </div>
                        <button class="auth-button" id="registerButton">Daftar</button>
                    </div>
                </div>
            `;
            
            // Event listener untuk tabs
            const tabs = document.querySelectorAll('.auth-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding content
                    document.querySelectorAll('.auth-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabName}Content`).classList.add('active');
                });
            });
            
            // Event listener untuk tombol login
            document.getElementById('loginButton').addEventListener('click', handleLogin);
            
            // Event listener untuk tombol register
            document.getElementById('registerButton').addEventListener('click', handleRegister);
        }

        // Render profil pengguna
        function renderUserProfile() {
            const firstLetter = currentUser.username.charAt(0).toUpperCase();
            authSection.innerHTML = `
                <div class="user-profile">
                    <h3>Profil Pengguna</h3>
                    <div class="profile-info">
                        <div class="profile-avatar">${firstLetter}</div>
                        <div class="profile-details">
                            <div class="profile-name">${currentUser.username}</div>
                            <div class="profile-rank">${currentUser.rank}</div>
                        </div>
                    </div>
                    <button class="logout-button" id="logoutButton">Keluar</button>
                </div>
            `;
            
            // Event listener untuk tombol logout
            document.getElementById('logoutButton').addEventListener('click', handleLogout);
        }

        // Handle login
        function handleLogin() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!username || !password) {
                alert('Harap isi semua field!');
                return;
            }
            
            // Cek user di localStorage
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                renderUserProfile();
                renderChatContainer();
                alert(`Selamat datang, ${username}!`);
            } else {
                alert('Nama pengguna atau kata sandi salah!');
            }
        }

        // Handle register
        function handleRegister() {
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            
            if (!username || !password || !confirmPassword) {
                alert('Harap isi semua field!');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Kata sandi tidak cocok!');
                return;
            }
            
            // Cek apakah username sudah ada
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const existingUser = users.find(u => u.username === username);
            
            if (existingUser) {
                alert('Nama pengguna sudah digunakan!');
                return;
            }
            
            // Buat user baru
            const newUser = {
                username: username,
                password: password,
                rank: username === 'admin' ? 'admin' : 'member' // Jika username admin, maka rank admin
            };
            
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            // Auto login setelah register
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            renderUserProfile();
            renderChatContainer();
            alert('Pendaftaran berhasil! Anda telah login.');
        }

        // Handle logout
        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            renderAuthForm();
            renderChatLoginPrompt();
            alert('Anda telah logout.');
        }

        // Render chat container
        function renderChatContainer() {
            if (currentUser) {
                chatContainer.innerHTML = `
                    <div class="chat-container">
                        <div class="chat-messages" id="chatMessages">
                            ${renderChatMessages()}
                        </div>
                        <div class="chat-input">
                            <input type="text" id="chatInput" placeholder="Ketik pesan...">
                            <button id="sendMessage">Kirim</button>
                        </div>
                    </div>
                `;
                
                // Event listener untuk tombol kirim
                document.getElementById('sendMessage').addEventListener('click', sendMessage);
                
                // Event listener untuk tekan enter di input
                document.getElementById('chatInput').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
                
                // Scroll ke bawah chat
                const chatMessages = document.getElementById('chatMessages');
                if (chatMessages) {
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }
            } else {
                renderChatLoginPrompt();
            }
        }

        // Render chat login prompt
        function renderChatLoginPrompt() {
            chatContainer.innerHTML = `
                <div class="chat-login-prompt">
                    <p>Kamu belum login</p>
                    <p>Silahkan login terlebih dahulu untuk memulai chat</p>
                </div>
            `;
        }

        // Load chat messages
        function loadChatMessages() {
            chatMessages = JSON.parse(localStorage.getItem('chatMessages') || '[]');
        }

        // Render chat messages
        function renderChatMessages() {
            return chatMessages.map(msg => {
                const isCurrentUser = msg.username === currentUser.username;
                return `
                    <div class="chat-message ${isCurrentUser ? 'message-user' : 'message-other'}">
                        <div class="message-sender">${msg.username}</div>
                        <div class="message-text">${msg.text}</div>
                        <div class="message-time">${msg.time}</div>
                    </div>
                `;
            }).join('');
        }

        // Send message
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            
            if (!text) return;
            
            // Buat pesan baru
            const now = new Date();
            const time = `${now.getHours()}:${String(now.getMinutes()).padStart(2, '0')}`;
            
            const newMessage = {
                username: currentUser.username,
                text: text,
                time: time
            };
            
            // Tambahkan ke chat messages
            chatMessages.push(newMessage);
            localStorage.setItem('chatMessages', JSON.stringify(chatMessages));
            
            // Clear input
            input.value = '';
            
            // Update tampilan chat
            renderChatContainer();
        }

        // Inisialisasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', function() {
            countUniqueVisitor();
            initializeRating();
            initializeTheme();
            initializeAuth();
            
            // Buat akun admin default jika belum ada
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const adminUser = users.find(u => u.username === 'admin');
            if (!adminUser) {
                users.push({
                    username: 'admin',
                    password: 'admin123',
                    rank: 'admin'
                });
                localStorage.setItem('users', JSON.stringify(users));
            }
        });
    </script>
</body>
</html>